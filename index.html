<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>مطعم رغيف الفيصلية - القائمة</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>

    <style>
        :root {
            --bg-color: #f8f4f0;
            --surface-color: #ffffff;
            --primary-color: #d87525;
            --primary-color-dark: #b85e1a;
            --text-color-primary: #3d352e;
            --text-color-secondary: #7a6a5d;
            --accent-color: #28a745;
            --border-color: #e0d5c1;
            --shadow-color: rgba(0, 0, 0, 0.08);
            --font-family: 'Tajawal', sans-serif;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: var(--font-family); background-color: var(--bg-color);
            color: var(--text-color-primary); line-height: 1.7; overflow-x: hidden;
            user-select: none; -webkit-user-select: none; /* Disable text selection */
        }
        input, textarea {
            user-select: text; -webkit-user-select: text; /* Re-enable for form fields */
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        .currency-symbol {
            display: inline-block; width: 0.9em; height: 0.9em;
            vertical-align: -0.1em; margin: 0 2px;
            content: url('https://upload.wikimedia.org/wikipedia/commons/thumb/9/98/Saudi_Riyal_Symbol.svg/800px-Saudi_Riyal_Symbol.svg.png');
        }

        #loading-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: #fff; display: flex; justify-content: center; align-items: center; z-index: 9999; transition: opacity 0.7s ease-out, visibility 0.7s ease-out; }
        #loading-screen.hidden { opacity: 0; visibility: hidden; pointer-events: none; }
        #loading-screen img { max-width: 250px; animation: pulse 1.8s infinite ease-in-out; }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.08); } }
        
        .navbar { background-color: rgba(255, 255, 255, 0.85); backdrop-filter: blur(10px); padding: 12px 20px; box-shadow: 0 2px 10px var(--shadow-color); display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 1000; }
        .navbar-brand { font-size: 1.8em; font-weight: 800; color: #b12128; text-decoration: none; }
        .cart-toggle-button { background: none; border: none; font-size: 1.6em; color: #b12128; cursor: pointer; position: relative; padding: 8px; text-decoration: none; }
        .cart-count-badge { position: absolute; top: 0px; right: 0px; background-color: var(--primary-color); color: white; font-size: 0.6em; padding: 3px 7px; border-radius: 50%; font-weight: 700; border: 2px solid white; }
        
        .page-header { text-align: center; margin: 40px 0; }
        .page-header img { max-width: 300px; margin-bottom: 15px; }
        .page-title { font-size: 2.8em; font-weight: 800; color:#b12128; }
        .search-controls { display: flex; justify-content: space-between; align-items: center; gap: 15px; margin-bottom: 20px; flex-wrap: wrap; }
        .search-container { position: relative; flex-grow: 1; }
        #search-input { width: 100%; padding: 12px 20px 12px 45px; border: 1px solid var(--border-color); background: var(--surface-color); border-radius: 25px; font-family: var(--font-family); font-size: 1em; outline: none; box-shadow: 0 2px 8px var(--shadow-color); transition: border-color 0.3s, box-shadow 0.3s; }
        #search-input:focus { border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(216, 117, 37, 0.2), 0 2px 8px var(--shadow-color); }
        .search-icon { position: absolute; left: 18px; top: 50%; transform: translateY(-50%); color: #aaa; }
        .view-toggle-btn { background-color: var(--surface-color); color: var(--text-color-secondary); border: 1px solid var(--border-color); padding: 10px 14px; border-radius: 25px; cursor: pointer; font-size: 1.2em; transition: all 0.3s ease; box-shadow: 0 2px 8px var(--shadow-color); flex-shrink: 0; }
        .view-toggle-btn:hover { border-color: var(--primary-color); color: var(--primary-color); }
        .view-toggle-btn.active-compact-view { background-color: var(--primary-color); color: white; border-color: var(--primary-color); }
        .filters-container-wrapper { overflow-x: auto; padding-bottom: 10px; margin-bottom: 30px; }
        .filters-container-wrapper::-webkit-scrollbar { height: 6px; }
        .filters-container-wrapper::-webkit-scrollbar-thumb { background: var(--primary-color); border-radius: 10px; }
        .filters-container { display: flex; flex-wrap: nowrap; gap: 12px; padding: 5px 0; }
        .filter-btn { background-color: rgba(255, 255, 255, 0.7); color: var(--text-color-secondary); border: 1px solid var(--border-color); padding: 10px 22px; border-radius: 22px; cursor: pointer; font-size: 1em; font-family: var(--font-family); font-weight: 500; transition: all 0.3s ease; white-space: nowrap; }
        .filter-btn:hover { background-color: var(--primary-color); color: white; border-color: var(--primary-color); }
        .filter-btn.active { background-color: var(--primary-color); color: white; border-color: var(--primary-color-dark); font-weight: 700; box-shadow: 0 2px 5px rgba(216, 117, 37, 0.3); }
        .category-section { margin-bottom: 50px; }
        .category-title { font-size: 2em; font-weight: 700; margin-bottom: 25px; text-align: right; padding-bottom: 10px; border-bottom: 3px solid var(--primary-color); display: inline-block; }
        .products-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 25px; }
        .product-card { background-color: var(--surface-color); border: 1px solid var(--border-color); border-radius: 12px; box-shadow: 0 4px 15px var(--shadow-color); transition: all 0.3s ease; display: flex; flex-direction: column; overflow: hidden; }
        .product-card:hover { transform: translateY(-5px); box-shadow: 0 8px 25px rgba(0,0,0,0.12); }
        .product-card img { width: 100%; height: 200px; object-fit: cover; transition: all 0.3s ease; }
        .product-card:hover img { transform: scale(1.05); }
        .product-info { padding: 15px; display: flex; flex-direction: column; flex-grow: 1; text-align: right; }
        .product-card h3 { margin: 0 0 5px 0; font-size: 1.25em; font-weight: 700; }
        .product-description { font-size: 0.9em; color: var(--text-color-secondary); margin-bottom: 15px; min-height: 45px; transition: all 0.3s ease; }
        .price-and-action { display: flex; justify-content: space-between; align-items: center; margin-top: auto; transition: all 0.3s ease; }
        .product-card .price { font-size: 1.3em; font-weight: 800; color: #1e191a; }
        .product-card .action-btn { background-color: var(--primary-color); color: white; border: none; padding: 10px 18px; font-size: 0.95em; font-family: var(--font-family); font-weight: 500; border-radius: 8px; cursor: pointer; transition: background-color 0.3s, transform 0.2s; display: flex; align-items: center; gap: 8px; }
        .product-card .action-btn:hover { background-color: var(--primary-color-dark); transform: scale(1.05); }
        .product-attributes { display: flex; flex-wrap: wrap; justify-content: flex-end; gap: 8px; margin: 0 0 10px; min-height: 22px; }
        .attr-icon { display: inline-block; width: 22px; height: 22px; background-size: contain; background-repeat: no-repeat; background-position: center; position: relative; }
        .attr-icon::after { content: attr(title); position: absolute; bottom: 125%; left: 50%; transform: translateX(-50%); background-color: var(--text-color-primary); color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: 500; white-space: nowrap; opacity: 0; visibility: hidden; z-index: 10; transition: opacity 0.2s, visibility 0.2s; pointer-events: none; }
        .attr-icon:hover::after { opacity: 1; visibility: visible; }
        .attr-icon--salt { background-image: url("https://blogger.googleusercontent.com/img/a/AVvXsEh0ULR_-qfH3jXKRAVLOhyEBz6iMMh9Om5zWuw2ApOSfRPBgxRyDM5ho6hCW18gu8lZGkrFS5Qt5PjTDq1JKiQldnIviLBGZTOJzS3lDk9oZjULYgxtL_N7CBieqX3W_xXPlZXasN9g-dYc5wWBtc_09tJXBwfDCw6Hx8gM6Xtz5wLUZ2XtukEJRVzpLQ6I"); }
        .attr-icon--pepper { background-image: url("https://blogger.googleusercontent.com/img/a/AVvXsEg0oX6tnFyk_-dfBr9Vh7IOZeH9PKh93414Nw1zsB7idRHoSvDhK7KdX61w6QMt0cfpZJrWHFFbxJoaCiyN1B9z5KxtYgBwP3PbnBdSzvHCJgM3THm5BUOD1Np1iAu7anVYEI-NQI94DPcH_ta2ZA5Ga0lq9nquQXvNfoyiYJpTwMf9qnNGTQnvyLDrkRx5"); }
        .attr-icon--spicy { background-image: url("https://blogger.googleusercontent.com/img/a/AVvXsEhNganEQwvnDVOpjznRnQqFv4m_VgajDdS7scUDFdsJFjR9oTJkZrG1xWWH-Ojdhh5zPZPZ2QxDG9Gw2DmNJl0KD9_HlhTIYsjhJcpJb_efoSsPPoBIM5ZD_GXUMXlHrB3pDH8GxqRPzzG5A273fy8XRSHT2MIDydFWfJq5_QG7KM2UGcuQCOH7tM3VYYHK"); }
        .attr-icon--wheat { background-image: url("https://blogger.googleusercontent.com/img/a/AVvXsEivRE0H0a-Azi_4gE7q4cYGb1N_oexjm6OfZJ7UxhnWtjLp9qF81MGoLHZXkZPTJA2XhVwcZu62DCnB3FmcolDGtg6b-Nvwx4zu-vcBMjodgq7u33YpMB8CawjyIAl0kNL4FF0u28QzxxJ61fsmPbc8_1yLIk3Kn4TiHI-vAu9_535UMN_YyfIV1eaM6pqm"); }
        .attr-icon--milk { background-image: url("https://blogger.googleusercontent.com/img/a/AVvXsEgETisjhlYtOYMh5MSlcKDP86n3zj7t5kHdvXhmmmByAqu-dFcNhYHIEJuTbZJanGQVUorWV4_w5KB1JqeoReLm4HONWChdtTG5koSA8OgfIKBL5mAbmBqnlF459y6mlqIigk2ghVLL9Gf6CpfH9s3XBg9VHyiJr_GBhn6UWKwGx3BlCKRk7mtFtfWQ2-lj"); }
        .attr-icon--egg { background-image: url("https://blogger.googleusercontent.com/img/a/AVvXsEgsDg7Vfj6VKKZT64bAsy9SQI6NwdCT0R5QS5REDIcESfqP7QDPUmVPy-kX8-btWiFjzKBOcpWq8v0R1P2THTD6TQDx_4WHLvEmjVrDAUVpx1s1LsW-L3A-a6Xo-QENBryfeZxmQdlyDXgEFQuPMGci27I7uCxiXbGr-dT3ksz8Fg6XZtPLIrBX63SpyQ9l"); }
        .attr-icon--nuts { background-image: url("https://blogger.googleusercontent.com/img/a/AVvXsEhK9JloKvsYuje0UIj_dMoJhJiIgMuAkKXlnlxbTLYQrRdpjQPR0osOCmGfVPS3drn3j5lGIReUYBPiaJpsbXY-NIH4rFwraEXafe--uDzz9VylHHX4CAgrWh2kLijzpMGKWe_JWL9GdKLdGda_mQWiBhM6AXN16BEacc3mxpHyvMJLg6ftaksMQPbUT0vg"); }
        .attr-icon--peanut { background-image: url("https://blogger.googleusercontent.com/img/a/AVvXsEjMGhMiRYtg67oQSdC3vzQbra3KEKELN1JMGAfhHqD7-WjW6wyj0dBQsB6kBEAvnKgYMDtD4gGny_JEZRItm89RN7DXmRd9_MYulukoB-06r3XIe5Aw83D7zc1Ozr3BibW7ATeA_K3TYXiklgGLhCRAVfkuKmakr9pohRj6rScWiPJd7uVkpgavPtCCyDsS"); }
        .attr-icon--fish { background-image: url("https://blogger.googleusercontent.com/img/a/AVvXsEgvzL0lv4dvOOnYHJYmlHAFmvKKB8biBXIV2OpyQBIwJ8Akendu1J9qvjUOe9A5h3TWP9-ZOw--hyXziRDGfYhKA2KFu142RhmIs_pEkycz1kcroAPFxiYuE09JDpZndKe20TdXVTTEHYIPcqga9SevOkVkUFN9LerrRtoYZ4KcAzZzF4fWYLQIRz0YkMRu"); }
        .attr-icon--shellfish { background-image: url("https://blogger.googleusercontent.com/img/a/AVvXsEhsrtwPjfrCvjd6LBn8QiM_mLuBh1LashDhPR5zKfRIusp68OACFChwrGLwGlXbqTRnAx8MtwiXZLbhitopsjQRuZvuO88uR4jcUHqmABqN8Opi5DhqmFHGrNTT_knv70yZdpPASbbXBH3ue0cUOnGj2O89ACQch7y3j5cJmTYN36Sut2WNOGl9_qGaNNfa"); }
        .attr-icon--soy { background-image: url("https://blogger.googleusercontent.com/img/a/AVvXsEhuk7XfzJjfrqRkVY7SR9sX9u5eoM7N0iYkcBHtr3os8d79U1K9pOqAebeEEPv1Ys09CMr2FyQrDkY_OCHpGtOzJiovLlP5FcM947LGlZXPoGb-uV-VZYMGEYoz2BEc9ahzajCalOGr6Z0WAdhz2LF6CeQb8GEGD-Gu3VUR_RQozACHk3D1KJKKSVbicfKf"); }
        .attr-icon--sesame { background-image: url("https://blogger.googleusercontent.com/img/a/AVvXsEj5WRTqKm_NErM7KVOgFwOW823p2xtR_1Z6__rGAI49S2ZI4h0AS0giS63ohdFjQ5iv04KHNTn4aEY-HyKUObjxaRYEPo3nH1LDCIgN_EI2ZtIoGQXNupERPlcJweOCDq0l5UkJxm7wr-evdtV7q5pp9odYmfstNKbBfCw2P2XERJLRVq3hA0jo-88Na_KE"); }

        /* --- Compact View Styles --- */
        body.compact-view .products-grid { grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; }
        body.compact-view .product-card img { height: 120px; }
        body.compact-view .product-card h3 { font-size: 1.1em; }
        body.compact-view .product-description { min-height: 20px; font-size: 0.8em; margin-bottom: 10px; }
        body.compact-view .price-and-action { flex-direction: column; align-items: stretch; gap: 10px; }
        body.compact-view .product-card .price { text-align: center; }

        /* --- Modal Styles --- */
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.6); z-index: 1001; justify-content: center; align-items: center; }
        .modal-overlay.active { display: flex; }
        .modal-content { background-color: var(--surface-color); padding: 20px; border-radius: 12px; box-shadow: 0 5px 20px rgba(0,0,0,0.2); width: 90%; max-width: 600px; max-height: 90vh; overflow-y: auto; position: relative; animation: fadeInModal 0.3s ease-out; }
        @keyframes fadeInModal { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
        .modal-close-btn { position: absolute; top: 15px; left: 15px; background: none; border: none; font-size: 2.5em; color: #aaa; cursor: pointer; line-height: 1; z-index: 10; }
        
        /* "About Us" Modal Content */
        .about-header { text-align: center; margin-bottom: 25px; }
        .about-header img { max-width: 200px; margin-bottom: 10px; }
        .about-header h2 { font-size: 2em; color: #b12128; }
        .about-section { margin-bottom: 25px; }
        .about-section h4 { font-size: 1.3em; color: var(--primary-color); margin-bottom: 15px; text-align: center; }
        .about-socials { text-align: center; }
        .about-socials a { color: var(--text-color-primary); font-size: 1.8em; margin: 0 12px; transition: color 0.3s, transform 0.2s; }
        .about-socials a:hover { color: var(--primary-color); transform: translateY(-3px); }
        .allergen-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        .allergen-table td { padding: 10px; border-bottom: 1px solid var(--border-color); vertical-align: middle; }
        .allergen-table td:first-child { width: 40px; text-align: center; }
        .about-footer { margin-top: 30px; text-align: center; font-size: 0.85em; color: var(--text-color-secondary); }
        .about-footer p { margin-bottom: 5px; }
        
        /* Customization Modal */
        #customization-modal-overlay .modal-content { max-width: 550px; }
        .modal-product-image { width: 100%; height: 220px; object-fit: cover; border-radius: 8px; margin-bottom: 20px; }
        .modal-product-title { font-size: 1.8em; color: var(--primary-color); margin-bottom: 10px; text-align: center; font-weight: 700; }
        .modal-product-base-price, .modal-current-item-price { text-align: center; margin-bottom: 15px; }
        .modal-product-base-price { font-size: 1.2em; color: var(--text-color-secondary); }
        .modal-current-item-price { font-size: 1.3em; color: var(--primary-color); font-weight: bold; margin-top: 5px; }
        .modal-customizations .option-group { margin-bottom: 20px; border-top: 1px solid var(--border-color); padding-top: 15px; }
        .modal-customizations .option-group legend { font-weight: 700; margin-bottom: 10px; font-size: 1.1em; }
        .modal-customizations .option-item { display: block; margin-bottom: 8px; font-size: 1em; }
        .modal-customizations .option-item label { margin-right: 8px; cursor: pointer; }
        .modal-customizations .option-item input { margin-left: 10px; }
        .modal-quantity-controls { display: flex; justify-content: center; align-items: center; margin: 25px 0; }
        .modal-quantity-controls input[type="number"] { width: 70px; padding: 10px; text-align: center; border: 1px solid var(--border-color); border-radius: 8px; font-size: 1.1em; margin: 0 10px; }
        .modal-add-to-cart-btn { background-color: var(--primary-color); color: white; border: none; padding: 14px 25px; text-align: center; display: block; width: 100%; font-size: 1.2em; border-radius: 8px; cursor: pointer; transition: background-color 0.3s; }
        .modal-add-to-cart-btn:hover { background-color: var(--primary-color-dark); }
        
        /* --- Cart Modal Styles --- */
        #cart-modal-overlay .modal-content { max-width: 800px; }
        .checkout-header h2 { font-size: 2em; color: var(--primary-color); font-weight: 800; text-align: center; margin-bottom: 25px; }
        .cart-items-list-container { max-height: 300px; overflow-y: auto; padding: 0 10px; margin-bottom: 20px; background: #fafafa; border-radius: 8px; border: 1px solid #eee; }
        .cart-items-list { list-style-type: none; padding: 0; }
        .cart-items-list li { padding: 15px 10px; border-bottom: 1px dashed #ddd; display: flex; justify-content: space-between; align-items: flex-start; }
        .cart-item-details { flex-grow: 1; margin-right: 15px; }
        .cart-item-details .item-name { font-weight: 700; font-size: 1.1em; }
        .cart-item-details .item-customizations { font-size: 0.85em; color: var(--text-color-secondary); margin-top: 5px; }
        .cart-item-actions { text-align: left; flex-shrink: 0;}
        .item-total-price { font-weight: bold; display: block; }
        .remove-item-btn { background: none !important; color: #e74c3c !important; border: none; padding: 5px !important; font-size: 1em !important; cursor: pointer; margin-top: 5px; }
        #empty-cart-message { text-align: center; color: var(--text-color-secondary); padding: 40px 20px; font-size: 1.1em; }
        #checkout-footer-section { padding-top: 20px; border-top: 1px solid var(--border-color); }
        .delivery-options, .payment-options { margin-bottom: 15px; text-align: center; }
        .delivery-options label, .payment-options label { margin: 0 10px; }
        #location-section { display: none; margin-top: 15px; padding: 15px; background-color: #fffaf2; border: 1px dashed var(--primary-color); border-radius: 8px; text-align: center; }
        #get-location-btn { background-color: #555; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-family: var(--font-family); font-size: 1em; transition: background-color 0.3s; }
        #get-location-btn.success { background-color: var(--primary-color); }
        #location-feedback { margin-top: 10px; font-size: 0.9em; color: var(--text-color-secondary); }
        #location-feedback a { color: var(--primary-color); font-weight: bold; }
        .payment-options-title { display: block; margin-bottom: 10px; font-weight: 700; }
        #general-order-notes { width: 100%; padding: 10px; margin-bottom: 15px; border: 1px solid var(--border-color); border-radius: 8px; min-height: 70px; font-family: var(--font-family); font-size: 1em; }
        .summary-line { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 1em; }
        .summary-line.total { font-weight: 700; font-size: 1.3em; color: var(--primary-color); margin-top: 10px; }
        .cart-actions { display: flex; flex-direction: column; gap: 10px; margin-top: 15px; }
        .checkout-btn-whatsapp { width: 100%; background-color: #25D366; color: white; border: none; padding: 14px 20px; font-size: 1.1em; font-weight: 700; border-radius: 8px; transition: background-color 0.3s; cursor: pointer; }
        .checkout-btn-whatsapp:hover { background-color: #1ebe58; }
        .clear-cart-btn { width: 100%; background-color: #95a5a6; color: white; font-size: 0.9em; padding: 10px 15px; border-radius: 8px; cursor: pointer; border: none;}
        .map-modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center; }
        
        /* ========== START: THIS IS THE FIX ========== */
        .map-modal-overlay.active {
            display: flex;
        }
        /* ========== END: THIS IS THE FIX ========== */

        .map-modal-content { background-color: white; padding: 20px; border-radius: 12px; width: 90%; max-width: 700px; box-shadow: 0 5px 20px rgba(0,0,0,0.2); }
        .map-modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .map-modal-header h3 { color: var(--primary-color); font-size: 1.5em; }
        .map-modal-close-btn { background: none; border: none; font-size: 2.5em; color: #aaa; cursor: pointer; line-height: 1; }
        #map { height: 400px; width: 100%; border-radius: 8px; border: 1px solid var(--border-color); }
        .map-modal-footer { text-align: center; margin-top: 15px; }
        #confirm-location-btn { background-color: var(--primary-color); color: white; border: none; padding: 12px 30px; font-family: var(--font-family); font-size: 1.1em; border-radius: 8px; cursor: pointer; transition: background-color 0.3s; }
        #confirm-location-btn:hover { background-color: var(--primary-color-dark); }
        
        /* --- Notification Toast --- */
        .notification-toast {
            position: fixed; bottom: -100px; left: 50%; transform: translateX(-50%);
            background-color: var(--accent-color); color: white;
            padding: 15px 25px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 1003; transition: bottom 0.5s ease, opacity 0.5s ease;
            display: flex; align-items: center; gap: 10px;
            opacity: 0;
        }
        .notification-toast.show { bottom: 30px; opacity: 1; }

        /* --- Mobile Bottom Navigation --- */
        .mobile-nav { display: none; position: fixed; bottom: 0; left: 0; width: 100%; background-color: var(--surface-color); box-shadow: 0 -2px 10px var(--shadow-color); z-index: 1001; }
        .nav-list { display: flex; list-style: none; margin: 0; padding: 0; }
        .nav-item { flex: 1; text-align: center; padding: 8px 0; text-decoration: none; color: var(--text-color-secondary); display: flex; flex-direction: column; align-items: center; gap: 4px; transition: color 0.2s; position: relative; cursor: pointer; }
        .nav-item .cart-count-badge { right: calc(50% - 25px); top: 2px;}
        .nav-item i { font-size: 1.4em; }
        .nav-item span { font-size: 0.8em; font-weight: 500; }
        .nav-item.active { color: var(--primary-color); }
        
        /* --- Media Queries --- */
        @media (max-width: 768px) {
            body { padding-bottom: 80px; }
            .mobile-nav { display: block; }
            .navbar .cart-toggle-button { display: none; }
            .notification-toast.show { bottom: 80px; } 
            body.compact-view .products-grid { grid-template-columns: repeat(2, 1fr); }
        }

    </style>
</head>
<body>

    <div id="loading-screen">
        <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhGHYYhphUac3HG8T-OFi-5IZJMRRA9feFb0dbYZjPZY2gm7-GZzEoF61Nx1VLps5DB3tw17hM8UcrUT_Sxo631yxp4tOPZu8lCCVnpdiQ1n4i7EfUvpYK2KxYDKSX44XZhFH3_MmYwuoQGUUnB99DyWHj4cR4yjlvBSiZjqA4jWurYWFvhBaVv34Mnko6o/s1007/vydt.png" alt="جاري التحميل...">
    </div>

    <!-- About Us Modal -->
    <div class="modal-overlay" id="about-us-modal-overlay">
        <div class="modal-content">
            <button class="modal-close-btn" id="about-us-modal-close-btn">&times;</button>
            <div class="about-header"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhGHYYhphUac3HG8T-OFi-5IZJMRRA9feFb0dbYZjPZY2gm7-GZzEoF61Nx1VLps5DB3tw17hM8UcrUT_Sxo631yxp4tOPZu8lCCVnpdiQ1n4i7EfUvpYK2KxYDKSX44XZhFH3_MmYwuoQGUUnB99DyWHj4cR4yjlvBSiZjqA4jWurYWFvhBaVv34Mnko6o/s1007/vydt.png" alt="شعار المطعم"><h2>مطعم رغيف الفيصلية</h2></div>
            <div class="about-section"><h4>تواصل معنا</h4><div class="about-socials"><a href="#" aria-label="موقعنا على الخريطة"><i class="fas fa-map-marker-alt"></i></a><a href="#" aria-label="تيك توك"><i class="fab fa-tiktok"></i></a><a href="#" aria-label="إنستغرام"><i class="fab fa-instagram"></i></a><a href="#" aria-label="واتساب"><i class="fab fa-whatsapp"></i></a></div></div>

            <div class="about-footer"><p>يحتاج البالغون تقريباً إلى 2000 سعرة حرارية في المتكبير يوميا.</p><p>© <span id="current-year"></span> جميع الحقوق محفوظة لفريق حاجب سوفت.</p></div>
        </div>
    </div>

    <!-- Cart Modal -->
    <div class="modal-overlay" id="cart-modal-overlay">
        <div class="modal-content">
            <button class="modal-close-btn" id="cart-modal-close-btn">&times;</button>
            <div class="checkout-header"><h2>طلباتك</h2></div>
            <div class="cart-items-list-container"><ul id="cart-items-list" class="cart-items-list"></ul></div>
            <div id="checkout-footer-section">
                <div class="delivery-options"><label><input type="radio" name="deliveryType" value="pickup" checked> استلام</label><label><input type="radio" name="deliveryType" value="delivery"> توصيل</label></div>
                <div id="location-section"><button id="get-location-btn">📍 حدد موقعك</button><p id="location-feedback"></p></div>
                <div class="payment-options"><span class="payment-options-title">الدفع:</span><label><input type="radio" name="paymentMethod" value="cash" checked> كاش</label><label><input type="radio" name="paymentMethod" value="network"> شبكة</label></div>
                <textarea id="general-order-notes" placeholder="ملاحظات إضافية..."></textarea>
                <div class="summary-line"><span>المجموع الفرعي:</span><span><span id="cart-subtotal-amount">0</span><i class="currency-symbol"></i></span></div>
                <div class="summary-line" id="delivery-fee-line" style="display: none;"><span>رسوم التوصيل:</span><span id="delivery-fee-amount">0</span></div>
                <div class="summary-line total"><span>الإجمالي:</span><span><span id="cart-grand-total-amount">0</span><i class="currency-symbol"></i></span></div>
                <div class="cart-actions"><button class="checkout-btn-whatsapp" id="checkout-btn"><i class="fab fa-whatsapp"></i> إرسال الطلب</button><button class="clear-cart-btn" id="clear-cart-btn">إفراغ السلة</button></div>
            </div>
        </div>
    </div>
    
    <!-- Customization Modal -->
    <div class="modal-overlay" id="customization-modal-overlay">
        <div class="modal-content">
            <button class="modal-close-btn">&times;</button>
            <img src="" class="modal-product-image">
            <h2 class="modal-product-title"></h2>
            <p class="modal-product-base-price"></p><p class="modal-current-item-price"></p>
            <div class="modal-customizations"></div>
            <div class="modal-quantity-controls"><input type="number" value="1" min="1"></div>
            <button class="modal-add-to-cart-btn"><i class="fas fa-cart-plus"></i> أضف للطلبات</button>
        </div>
    </div>

    <!-- Map Modal -->
    <div class="map-modal-overlay" id="map-modal-overlay">
        <div class="map-modal-content">
            <div class="map-modal-header"><h3>اختر موقع التوصيل</h3><button class="map-modal-close-btn" id="map-modal-close-btn">&times;</button></div>
            <div id="map"></div>
            <div class="map-modal-footer"><button id="confirm-location-btn">تأكيد الموقع</button></div>
        </div>
    </div>

    <nav class="navbar">
        <a href="#" class="navbar-brand">رغيف الفيصلية</a>
        <a href="#" class="cart-toggle-button" id="desktop-cart-button" aria-label="الذهاب إلى سلة التسوق"><i class="fas fa-shopping-basket"></i><span class="cart-count-badge">0</span></a>
    </nav>

    <div class="container">
        <header class="page-header"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhGHYYhphUac3HG8T-OFi-5IZJMRRA9feFb0dbYZjPZY2gm7-GZzEoF61Nx1VLps5DB3tw17hM8UcrUT_Sxo631yxp4tOPZu8lCCVnpdiQ1n4i7EfUvpYK2KxYDKSX44XZhFH3_MmYwuoQGUUnB99DyWHj4cR4yjlvBSiZjqA4jWurYWFvhBaVv34Mnko6o/s1007/vydt.png" alt="شعار مطعم رغيف الفيصلية"><h1 class="page-title">قائمة الطعام</h1></header>
        <div class="search-controls"><div class="search-container"><i class="fas fa-search search-icon"></i><input type="text" id="search-input" placeholder="ابحث عن وجبتك المفضلة..."></div><button id="toggle-view-btn" class="view-toggle-btn" title="تغيير طريقة العرض"><i class="fas fa-th-large"></i></button></div>
        <div class="filters-container-wrapper"><div class="filters-container" id="filters-container"></div></div>
        <div id="menu-sections"></div>
    </div>
    
    <div class="notification-toast" id="notification-toast"><i class="fas fa-check-circle"></i> <span id="notification-message"></span></div>

    <nav class="mobile-nav">
        <div class="nav-list">
            <a href="#" class="nav-item active" id="nav-menu"><i class="fas fa-utensils"></i><span>القائمة</span></a>
            <a href="#" class="nav-item" id="nav-cart"><i class="fas fa-shopping-basket"></i><span class="cart-count-badge">0</span><span>السلة</span></a>
            <a href="#" class="nav-item" id="nav-about"><i class="fas fa-store"></i><span>من نحن</span></a>
        </div>
    </nav>
    
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script>
        const CART_STORAGE_KEY = 'ragheefAlFaisaliahCart_v3';
        const COMPACT_VIEW_STORAGE_KEY = 'ragheefAlFaisaliahView_v1';
        const whatsappNumber = "966539490701";
        const deliveryFee = 5;
        const freeDeliveryThreshold = 50; 
        const deliveryZoneCoords = [
            [21.533, 39.199], [21.533, 39.209], [21.523, 39.209], [21.523, 39.199]
        ];

    const productsData = [
    {
        "id": "id-a1b2c3d4",
        "name": "دونر مكس أجبان",
        "category": "ركن الدونر",
        "basePrice": 9,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjGy0wu2VphDifUhOffQh-sb_egdI7sq1eKdwY4kshbtE2NhSOvNNdMSNexhuEhrZOFLoQHMGjQn1rOMGt6LYuS6qkLxL_LaH5FDdOqQ3-tV1FhM-9yV0ini7HK5YBYN5aYIxf7Zw8avAe3okKd5iURN_BOvfnaf_UMKN1cNtvd79H2FS76m_caXdNEiQZL/s6000/30.png",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-b2c3d4e5",
        "name": "دونر دجاج مكسيكي",
        "category": "ركن الدونر",
        "basePrice": 10,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgPwAABjvJYuMYY1sNgxRv4hhYjQ8wKQOojVktcjlbp3pPBl60esCG4pO-bUZcykeBoKA84a6WhRveoYkb4EkQyeea2PvZgZfRvMorhcxNeLNmF5zlFw4aaObpdb3rJTfwwnRrTDvxGDM1ptC8eI75m3uazHngC0EBXC53BSjwsECPyqQN3tvk9EtTXE29s/s6000/35.png",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-c3d4e5f6",
        "name": "دونر كبده",
        "category": "ركن الدونر",
        "basePrice": 10,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi35bJkcAm8VnNZ3gqTJX25FQ3cGm_8XODYlowXmCwWQL17YYbXycacCoshxgD9GzSIY_3hXo6egqUVxpb6Sjocerj4xDMNN9LJ1laxqyIIjjUgoeoibIv-1J6l9CMGiJ57oVOMuoxFCpzhptZgtba_E39EMMf2LwS9WzJFm0zJYVlQgAwTnoHFZqUBj8R4/s6000/33.png",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-d4e5f6g7",
        "name": "دونر شكشوكة",
        "category": "ركن الدونر",
        "basePrice": 5,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhZovC0MLka8j87yrQX0heEW1xnSSrk0GOiQOThRvaltqnCE2jLMKOfRt7N9BwVztPpq5lyk7PwXQX_8LLJHalZqCre7pj7ZoMFUSQsDKtZWXlJzV6D9a7pcYHSPFVcgQtMsl2CSSMbfQ4VYN_pqN3w0uNWneJY8VNHIWmECyz303ZB6Fo0RdBgNFBnByfU/s6000/29.png",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-e5f6g7h8",
        "name": "دونر فلافل",
        "category": "ركن الدونر",
        "basePrice": 5,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgjkP6iUwy2MCdEcMMw8OAU53qoIy85o4_yInjWQJ_QvuUvud5mombqsedybM08wna47YIioKF8I-OlQnitvsjoyjuNYQhwTEgfYfuSe6_gx0UJUzEQI0BJcAOZzy_0pmltQcNyYU7BN-dxrctGtD0r9vqLrTTkFS4NoesB4JcQYjRt8YDfbRDW-SFU-l66/s6000/34.png",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-f6g7h8i9",
        "name": "دونر فلافل لبنه",
        "category": "ركن الدونر",
        "basePrice": 7,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgPwAABjvJYuMYY1sNgxRv4hhYjQ8wKQOojVktcjlbp3pPBl60esCG4pO-bUZcykeBoKA84a6WhRveoYkb4EkQyeea2PvZgZfRvMorhcxNeLNmF5zlFw4aaObpdb3rJTfwwnRrTDvxGDM1ptC8eI75m3uazHngC0EBXC53BSjwsECPyqQN3tvk9EtTXE29s/s6000/35.png",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-g7h8i9j0",
        "name": "دونر حلوم",
        "category": "ركن الدونر",
        "basePrice": 10,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhZrRd6uJEQ6ZncFdHsRXWiyVi4iqMiycoOncPPBy6P2SDL2Zqo1X9uWJVd6QJVSDXhWH8p-XPMpCoErVFdzRFHBQAPtsD53CLnxKUvQ7Dc8nDBU-rk7WFQIIq0wpy2uW65vt1CDbaQO_GSxTv687AuOdpnf_fEdu6L-ysWfp8K2SfrfNNP8RQfEq8jGB4t/s6000/28.png",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-h8i9j0k1",
        "name": "دونر بيض",
        "category": "ركن الدونر",
        "basePrice": 5,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjGy0wu2VphDifUhOffQh-sb_egdI7sq1eKdwY4kshbtE2NhSOvNNdMSNexhuEhrZOFLoQHMGjQn1rOMGt6LYuS6qkLxL_LaH5FDdOqQ3-tV1FhM-9yV0ini7HK5YBYN5aYIxf7Zw8avAe3okKd5iURN_BOvfnaf_UMKN1cNtvd79H2FS76m_caXdNEiQZL/s6000/30.png",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-i9j0k1l2",
        "name": "دونر لحم مفروم",
        "category": "ركن الدونر",
        "basePrice": 10,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgPwAABjvJYuMYY1sNgxRv4hhYjQ8wKQOojVktcjlbp3pPBl60esCG4pO-bUZcykeBoKA84a6WhRveoYkb4EkQyeea2PvZgZfRvMorhcxNeLNmF5zlFw4aaObpdb3rJTfwwnRrTDvxGDM1ptC8eI75m3uazHngC0EBXC53BSjwsECPyqQN3tvk9EtTXE29s/s6000/35.png",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-j0k1l2m3",
        "name": "دونر جبن",
        "category": "ركن الدونر",
        "basePrice": 5,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjGy0wu2VphDifUhOffQh-sb_egdI7sq1eKdwY4kshbtE2NhSOvNNdMSNexhuEhrZOFLoQHMGjQn1rOMGt6LYuS6qkLxL_LaH5FDdOqQ3-tV1FhM-9yV0ini7HK5YBYN5aYIxf7Zw8avAe3okKd5iURN_BOvfnaf_UMKN1cNtvd79H2FS76m_caXdNEiQZL/s6000/30.png",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-k1l2m3n4",
        "name": "دونر نوتيلا",
        "category": "ركن الدونر",
        "basePrice": 5,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhcj5I197pKFDk792OKn_-BKZJnc04sbxUg5w_CN4Vn0Tn24S9c817RRe4CTf2cTemxj9t4PoE3J8Iidyv-un9QBJ_vBkM-S50K4c6iYeaT4bx1axDkpa7uymIQBmdrxe18gnG3Lp82D6SsZjPf8gThropdvdQuoif8pr6Y6D-V5SE3m7lbnWL5SSlUC1tl/s6000/26.png",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-m3n4o5p6",
        "name": "بوكس الميني دونر",
        "category": "ركن البوكسات",
        "basePrice": 45,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-n4o5p6q7",
        "name": "بوكس الباستريز",
        "category": "ركن البوكسات",
        "basePrice": 35,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-o5p6q7r8",
        "name": "بوكس الفلافل",
        "category": "ركن البوكسات",
        "basePrice": 35,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-p6q7r8s9",
        "name": "مشكل ميني",
        "category": "ركن المعجنات",
        "basePrice": 25,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh86-oUmD4OuP73LCavYYtWP8PTg4r13thEWdblf60xeTl1npjZzdEzYxFTIFy55nlwjCjPWKfPNqb4pdSsVHIBc75MoWwokmteaj1iKTrq3hnN_LJN3-p3spV_POnIQKGcMEQZ7C4z66gce8lC_bPnwn0Wd74hGdQBBMTMV2ZH7sfjGQkpjwwjL4wRJ090/s6000/39.png",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_p6q7r8s9",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "وسط",
                        "value": "وسط",
                        "price": 20
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 40
                    }
                ]
            }
        ]
    },
    {
        "id": "id-q7r8s9t0",
        "name": "زعتر صغير",
        "category": "ركن المعجنات",
        "basePrice": 4,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_q7r8s9t0",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 2
                    }
                ]
            }
        ]
    },
    {
        "id": "id-r8s9t0u1",
        "name": "زعتر لبناني",
        "category": "ركن المعجنات",
        "basePrice": 5,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_r8s9t0u1",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-s9t0u1v2",
        "name": "زعتر رغيف",
        "category": "ركن المعجنات",
        "basePrice": 5,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_s9t0u1v2",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-t0u1v2w3",
        "name": "جبن عكاوي",
        "category": "ركن المعجنات",
        "basePrice": 4,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_t0u1v2w3",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-u1v2w3x4",
        "name": "جبن سايل",
        "category": "ركن المعجنات",
        "basePrice": 4,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_u1v2w3x4",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-v2w3x4y5",
        "name": "جبن شيدر",
        "category": "ركن المعجنات",
        "basePrice": 4,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_v2w3x4y5",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-w3x4y5z6",
        "name": "جبن بيض",
        "category": "ركن المعجنات",
        "basePrice": 5,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_w3x4y5z6",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-x4y5z6a7",
        "name": "جبن زعتر",
        "category": "ركن المعجنات",
        "basePrice": 5,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_x4y5z6a7",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-y5z6a7b8",
        "name": "جبن زيتون",
        "category": "ركن المعجنات",
        "basePrice": 5,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_y5z6a7b8",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-z6a7b8c9",
        "name": "جبن لبنه",
        "category": "ركن المعجنات",
        "basePrice": 5,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_z6a7b8c9",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-a7b8c9d0",
        "name": "جبن عسل",
        "category": "ركن المعجنات",
        "basePrice": 4,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_a7b8c9d0",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-b8c9d0e1",
        "name": "مشكل اجبان",
        "category": "ركن المعجنات",
        "basePrice": 6,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_b8c9d0e1",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-c9d0e1f2",
        "name": "لبنه",
        "category": "ركن المعجنات",
        "basePrice": 4,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_c9d0e1f2",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-d0e1f2g3",
        "name": "لبنه زعتر",
        "category": "ركن المعجنات",
        "basePrice": 4,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_d0e1f2g3",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-e1f2g3h4",
        "name": "لبنه عسل",
        "category": "ركن المعجنات",
        "basePrice": 4,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_e1f2g3h4",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-f2g3h4i5",
        "name": "لبنه زيتون",
        "category": "ركن المعجنات",
        "basePrice": 5,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_f2g3h4i5",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-g3h4i5j6",
        "name": "لبنه لحم",
        "category": "ركن المعجنات",
        "basePrice": 5,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_g3h4i5j6",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-h4i5j6k7",
        "name": "لبنه سبانخ",
        "category": "ركن المعجنات",
        "basePrice": 5,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_h4i5j6k7",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-i5j6k7l8",
        "name": "سبانخ",
        "category": "ركن المعجنات",
        "basePrice": 4,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_i5j6k7l8",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-j6k7l8m9",
        "name": "سبانخ بيض",
        "category": "ركن المعجنات",
        "basePrice": 5,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_j6k7l8m9",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-k7l8m9n0",
        "name": "سبانخ لحم",
        "category": "ركن المعجنات",
        "basePrice": 5,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_k7l8m9n0",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-l8m9n0o1",
        "name": "سبانخ جبن",
        "category": "ركن المعجنات",
        "basePrice": 5,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_l8m9n0o1",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-m9n0o1p2",
        "name": "سبانخ مشكل",
        "category": "ركن المعجنات",
        "basePrice": 5,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_m9n0o1p2",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 4
                    }
                ]
            }
        ]
    },
    {
        "id": "id-n0o1p2q3",
        "name": "محمره",
        "category": "ركن المعجنات",
        "basePrice": 4,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_n0o1p2q3",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-o1p2q3r4",
        "name": "محمره لبنه",
        "category": "ركن المعجنات",
        "basePrice": 5,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_o1p2q3r4",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 4
                    }
                ]
            }
        ]
    },
    {
        "id": "id-p2q3r4s5",
        "name": "محمره لحم جبن",
        "category": "ركن المعجنات",
        "basePrice": 5,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_p2q3r4s5",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 4
                    }
                ]
            }
        ]
    },
    {
        "id": "id-q3r4s5t6",
        "name": "محمره جبن",
        "category": "ركن المعجنات",
        "basePrice": 4,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_q3r4s5t6",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 4
                    }
                ]
            }
        ]
    },
    {
        "id": "id-r4s5t6u7",
        "name": "محمره زعتر",
        "category": "ركن المعجنات",
        "basePrice": 4,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_r4s5t6u7",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-s5t6u7v8",
        "name": "محمره لحم",
        "category": "ركن المعجنات",
        "basePrice": 5,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_s5t6u7v8",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-t6u7v8w9",
        "name": "خبز لبناني صغير",
        "category": "ركن الشاورما",
        "basePrice": 7,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-u7v8w9x0",
        "name": "صاج صغير",
        "category": "ركن الشاورما",
        "basePrice": 8,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-v8w9x0y1",
        "name": "دونر شاورما",
        "category": "ركن الشاورما",
        "basePrice": 9,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEififiCBgcESx3FfNqnX_jYs-bw5S3yUNF05lx5NBGsHY1l3g3WFzGVL83mjJWkVSlbPFN4rw0Y6ra3mJWLuw7u9aYeACttObAU6wQql7haGSfr0eAOKALGNw8my5N8740BgXL_wvrtxZsJYfU_wAm5-OItFpCuJOdWk7lgVxmdQYdp217yDGcBM27rLBg3/s6000/32.png",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-w9x0y1z2",
        "name": "صاروخ",
        "category": "ركن الشاورما",
        "basePrice": 13,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-x0y1z2a3",
        "name": "صحن عربي 6 قطع",
        "category": "ركن الشاورما",
        "basePrice": 18,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-y1z2a3b4",
        "name": "صحن عربي 12 قطعه",
        "category": "ركن الشاورما",
        "basePrice": 33,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-z2a3b4c5",
        "name": "صحن عربي شرائح دجاج كبير",
        "category": "ركن الشاورما",
        "basePrice": 29,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-a3b4c5d6",
        "name": "صحن عربي شرائح دجاج كبير",
        "category": "ركن الشاورما",
        "basePrice": 57,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-b4c5d6e7",
        "name": "علبة ثوم",
        "category": "ركن الشاورما",
        "basePrice": 2,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-c5d6e7f8",
        "name": "علبة سبايسي",
        "category": "ركن الشاورما",
        "basePrice": 2,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-d6e7f8g9",
        "name": "علبة مكسيكي",
        "category": "ركن الشاورما",
        "basePrice": 2,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-e7f8g9h0",
        "name": "علبة طحينيه",
        "category": "ركن الشاورما",
        "basePrice": 2,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-f8g9h0i1",
        "name": "إضافة جبن",
        "category": "ركن الشاورما",
        "basePrice": 1,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-g9h0i1j2",
        "name": "إضافة سبايسي",
        "category": "ركن الشاورما",
        "basePrice": 1,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-h0i1j2k3",
        "name": "صفيحه شاميه",
        "category": "ركن الصفيحه الشاميه",
        "basePrice": 20,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_h0i1j2k3",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "ربع كيلو",
                        "value": "ربع كيلو",
                        "price": 0
                    },
                    {
                        "text": "نص كيلو",
                        "value": "نص كيلو",
                        "price": 20
                    },
                    {
                        "text": "كيلو",
                        "value": "كيلو",
                        "price": 60
                    }
                ]
            }
        ]
    },
    {
        "id": "id-i1j2k3l4",
        "name": "صفيحه جبن لحم",
        "category": "ركن الصفيحه الشاميه",
        "basePrice": 25,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_i1j2k3l4",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "ربع كيلو",
                        "value": "ربع كيلو",
                        "price": 0
                    },
                    {
                        "text": "نص كيلو",
                        "value": "نص كيلو",
                        "price": 20
                    },
                    {
                        "text": "كيلو",
                        "value": "كيلو",
                        "price": 65
                    }
                ]
            }
        ]
    },
    {
        "id": "id-j2k3l4m5",
        "name": "فطيره عش البلبل",
        "category": "ركن الفطاير",
        "basePrice": 10,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_j2k3l4m5",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 7
                    }
                ]
            }
        ]
    },
    {
        "id": "id-k3l4m5n6",
        "name": "فطيرة القشقوان",
        "category": "ركن الفطاير",
        "basePrice": 5,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_k3l4m5n6",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-l4m5n6o7",
        "name": "فلافل لبنة",
        "category": "ركن الفطاير",
        "basePrice": 5,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_l4m5n6o7",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 2
                    }
                ]
            }
        ]
    },
    {
        "id": "id-m5n6o7p8",
        "name": "فلافل جبن",
        "category": "ركن الفطاير",
        "basePrice": 5,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_m5n6o7p8",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 2
                    }
                ]
            }
        ]
    },
    {
        "id": "id-n6o7p8q9",
        "name": "لحم",
        "category": "ركن اللحم",
        "basePrice": 4,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_n6o7p8q9",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-o7p8q9r0",
        "name": "لحم جبن",
        "category": "ركن اللحم",
        "basePrice": 5,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_o7p8q9r0",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-p8q9r0s1",
        "name": "عرايس لحم",
        "category": "ركن اللحم",
        "basePrice": 14,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-q9r0s1t2",
        "name": "عرايس لحم جبن",
        "category": "ركن اللحم",
        "basePrice": 16,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-r0s1t2u3",
        "name": "نوتيلا",
        "category": "ركن النوتيلا",
        "basePrice": 5,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_r0s1t2u3",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-s1t2u3v4",
        "name": "نوتيلا جبن",
        "category": "ركن النوتيلا",
        "basePrice": 6,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_s1t2u3v4",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 3
                    }
                ]
            }
        ]
    },
    {
        "id": "id-t2u3v4w5",
        "name": "بيتزا الفصول الأربعه",
        "category": "ركن البيتزا",
        "basePrice": 22,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_t2u3v4w5",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 10
                    }
                ]
            }
        ]
    },
    {
        "id": "id-u3v4w5x6",
        "name": "بيتزا رغيف",
        "category": "ركن البيتزا",
        "basePrice": 12,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_u3v4w5x6",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 6
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 16
                    }
                ]
            }
        ]
    },
    {
        "id": "id-v4w5x6y7",
        "name": "بيتزا رانش",
        "category": "ركن البيتزا",
        "basePrice": 12,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_v4w5x6y7",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 6
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 16
                    }
                ]
            }
        ]
    },
    {
        "id": "id-w5x6y7z8",
        "name": "بيتزا إيطاليا",
        "category": "ركن البيتزا",
        "basePrice": 10,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_w5x6y7z8",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 7
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 16
                    }
                ]
            }
        ]
    },
    {
        "id": "id-x6y7z8a9",
        "name": "بيتزا مارغريتا",
        "category": "ركن البيتزا",
        "basePrice": 10,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_x6y7z8a9",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 7
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 16
                    }
                ]
            }
        ]
    },
    {
        "id": "id-y7z8a9b0",
        "name": "بيتزا ببروني",
        "category": "ركن البيتزا",
        "basePrice": 12,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_y7z8a9b0",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 6
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 16
                    }
                ]
            }
        ]
    },
    {
        "id": "id-z8a9b0c1",
        "name": "بيتزا خضار",
        "category": "ركن البيتزا",
        "basePrice": 11,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_z8a9b0c1",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 6
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 15
                    }
                ]
            }
        ]
    },
    {
        "id": "id-a9b0c1d2",
        "name": "بيتزا لحم",
        "category": "ركن البيتزا",
        "basePrice": 12,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_a9b0c1d2",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 6
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 16
                    }
                ]
            }
        ]
    },
    {
        "id": "id-b0c1d2e3",
        "name": "بيتزا دجاج",
        "category": "ركن البيتزا",
        "basePrice": 12,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_b0c1d2e3",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 6
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 16
                    }
                ]
            }
        ]
    },
    {
        "id": "id-c1d2e3f4",
        "name": "بيتزا فلافل",
        "category": "ركن البيتزا",
        "basePrice": 12,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_c1d2e3f4",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 6
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 16
                    }
                ]
            }
        ]
    },
    {
        "id": "id-d2e3f4g5",
        "name": "بيتزا كريمي سبانخ",
        "category": "ركن البيتزا",
        "basePrice": 12,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_d2e3f4g5",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 6
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 16
                    }
                ]
            }
        ]
    },
    {
        "id": "id-e3f4g5h6",
        "name": "بيتزا شاورما",
        "category": "ركن البيتزا",
        "basePrice": 14,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": [
            {
                "groupName": "الحجم",
                "name": "size_e3f4g5h6",
                "type": "radio",
                "required": true,
                "options": [
                    {
                        "text": "صغير",
                        "value": "صغير",
                        "price": 0
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 15
                    },
                    {
                        "text": "كبير",
                        "value": "كبير",
                        "price": 16
                    }
                ]
            }
        ]
    },
    {
        "id": "id-f4g5h6i7",
        "name": "ببسي",
        "category": "ركن المشروبات",
        "basePrice": 3,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-g5h6i7j8",
        "name": "ببسي دايت",
        "category": "ركن المشروبات",
        "basePrice": 3,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-h6i7j8k9",
        "name": "سفن اب",
        "category": "ركن المشروبات",
        "basePrice": 3,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-i7j8k9l0",
        "name": "سفن اب دايت",
        "category": "ركن المشروبات",
        "basePrice": 3,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-j8k9l0m1",
        "name": "ديو",
        "category": "ركن المشروبات",
        "basePrice": 3,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-k9l0m1n2",
        "name": "حمضيات",
        "category": "ركن المشروبات",
        "basePrice": 3,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-l0m1n2o3",
        "name": "ميراندا برتقال",
        "category": "ركن المشروبات",
        "basePrice": 3,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-m1n2o3p4",
        "name": "عصير الربيع",
        "category": "ركن المشروبات",
        "basePrice": 2,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    },
    {
        "id": "id-n2o3p4q5",
        "name": "ماء",
        "category": "ركن المشروبات",
        "basePrice": 1,
        "image": "",
        "description": "",
        "attributes": [],
        "customizations": []
    }
];

        document.addEventListener('DOMContentLoaded', () => {
            initializeApp();
        });

        function initializeApp() {
            try {
                // --- DOM Elements ---
                const loadingScreen = document.getElementById('loading-screen');
                const menuSectionsContainer = document.getElementById('menu-sections');
                const searchInput = document.getElementById('search-input');
                const filtersContainer = document.getElementById('filters-container');
                const notificationToast = document.getElementById('notification-toast');
                const notificationMessage = document.getElementById('notification-message');
                const aboutUsModal = document.getElementById('about-us-modal-overlay');
                const aboutUsCloseBtn = document.getElementById('about-us-modal-close-btn');
                const cartModal = document.getElementById('cart-modal-overlay');
                const cartModalCloseBtn = document.getElementById('cart-modal-close-btn');
                const customizationModal = document.getElementById('customization-modal-overlay');
                const customizationModalCloseBtn = customizationModal.querySelector('.modal-close-btn');
                const mapModal = document.getElementById('map-modal-overlay');
                const mapModalCloseBtn = document.getElementById('map-modal-close-btn');
                const allergenTable = document.querySelector('.allergen-table');
                const navMenuItems = document.querySelectorAll('.nav-item');
                const navMenuTab = document.getElementById('nav-menu');
                const navCartTab = document.getElementById('nav-cart');
                const navAboutTab = document.getElementById('nav-about');
                const desktopCartBtn = document.getElementById('desktop-cart-button');
                const cartBadges = document.querySelectorAll('.cart-count-badge');
                const toggleViewBtn = document.getElementById('toggle-view-btn');
                document.getElementById('current-year').textContent = new Date().getFullYear();
                
                // Cart & Modals Elements
                const cartItemsListElement = document.getElementById('cart-items-list');
                const cartSubtotalAmountElement = document.getElementById('cart-subtotal-amount');
                const deliveryFeeLineElement = document.getElementById('delivery-fee-line');
                const deliveryFeeAmountElement = document.getElementById('delivery-fee-amount');
                const cartGrandTotalAmountElement = document.getElementById('cart-grand-total-amount');
                const checkoutBtn = document.getElementById('checkout-btn');
                const clearCartBtn = document.getElementById('clear-cart-btn');
                const generalOrderNotesTextarea = document.getElementById('general-order-notes');
                const deliveryTypeRadios = document.querySelectorAll('input[name="deliveryType"]');
                const checkoutFooterSection = document.getElementById('checkout-footer-section');
                const locationSection = document.getElementById('location-section');
                const getLocationBtn = document.getElementById('get-location-btn');
                const locationFeedback = document.getElementById('location-feedback');
                const confirmLocationBtn = document.getElementById('confirm-location-btn');
                const modalProductImage = customizationModal.querySelector('.modal-product-image');
                const modalProductTitle = customizationModal.querySelector('.modal-product-title');
                const modalProductBasePrice = customizationModal.querySelector('.modal-product-base-price');
                const modalCurrentItemPrice = customizationModal.querySelector('.modal-current-item-price');
                const modalCustomizationsContainer = customizationModal.querySelector('.modal-customizations');
                const modalQuantityInput = customizationModal.querySelector('.modal-quantity-controls input');
                const modalAddToCartBtn = customizationModal.querySelector('.modal-add-to-cart-btn');

                // --- State ---
                let cart = [];
                let notificationTimeout;
                let currentActiveFilter = 'all';
                let currentSearchTerm = '';
                let isCompactView = false;
                let currentDeliveryType = 'pickup';
                let customerLocationLink = null;
                let map, marker, deliveryPolygon;
                let currentProductInModal = null;
                const allergenInfo = { salt: 'يحتوي على ملح', pepper: 'يحتوي على فلفل', spicy: 'حار', wheat: 'يحتوي على قمح (جلوتين)', milk: 'يحتوي على حليب', egg: 'يحتوي على بيض', nuts: 'يحتوي على مكسرات', peanut: 'يحتوي على فول سوداني', fish: 'يحتوي على سمك', shellfish: 'يحتوي على محار', soy: 'يحتوي على فول الصويا', sesame: 'يحتوي على سمسم' };

                // --- Core Functions ---
                const saveCart = () => localStorage.setItem(CART_STORAGE_KEY, JSON.stringify(cart));
                const loadCart = () => { cart = JSON.parse(localStorage.getItem(CART_STORAGE_KEY) || '[]'); };
                const saveViewPreference = () => localStorage.setItem(COMPACT_VIEW_STORAGE_KEY, isCompactView);

                function loadViewPreference() {
                    isCompactView = localStorage.getItem(COMPACT_VIEW_STORAGE_KEY) === 'true';
                    document.body.classList.toggle('compact-view', isCompactView);
                    toggleViewBtn.classList.toggle('active-compact-view', isCompactView);
                    toggleViewBtn.innerHTML = isCompactView ? '<i class="fas fa-th-list"></i>' : '<i class="fas fa-th-large"></i>';
                    toggleViewBtn.title = isCompactView ? "عرض عادي" : "عرض مضغوط";
                }
                
                function updateCartBadge() {
                    const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
                    cartBadges.forEach(badge => { badge.textContent = totalItems; });
                }

                function showNotification(message) {
                    notificationMessage.textContent = message;
                    notificationToast.classList.add('show');
                    clearTimeout(notificationTimeout);
                    notificationTimeout = setTimeout(() => notificationToast.classList.remove('show'), 3000);
                }

                window.addDirectToCart = function(productId) {
                    const product = productsData.find(p => p.id === productId);
                    const cartItemId = productId; // Simple ID for non-customized items
                    const existingItem = cart.find(item => item.cartItemId === cartItemId);
                    if (existingItem) {
                        existingItem.quantity++;
                    } else {
                        cart.push({ cartItemId, id: productId, name: product.name, quantity: 1, finalPricePerItem: product.basePrice, customizations: [] });
                    }
                    saveCart();
                    updateCartBadge();
                    showNotification(`تمت إضافة "${product.name}"`);
                };
                
                function displayProducts() {
                    menuSectionsContainer.innerHTML = '';
                    const searchTermLower = currentSearchTerm.toLowerCase();
                    const filteredProducts = productsData.filter(p => (currentActiveFilter === 'all' || p.category === currentActiveFilter) && (searchTermLower === '' || p.name.toLowerCase().includes(searchTermLower)));
                    if (filteredProducts.length === 0) { menuSectionsContainer.innerHTML = `<p style="text-align:center; padding: 20px;">لا توجد منتجات.</p>`; return; }
                    const productsByCategory = filteredProducts.reduce((acc, product) => { (acc[product.category] = acc[product.category] || []).push(product); return acc; }, {});
                    const displayOrder = currentActiveFilter === 'all' ? [...new Set(productsData.map(p => p.category))] : [currentActiveFilter];
                    
                    displayOrder.forEach(category => {
                        if (!productsByCategory[category]) return;
                        const categorySection = document.createElement('div');
                        categorySection.className = 'category-section';
                        categorySection.innerHTML = `<h2 class="category-title">${category}</h2><div class="products-grid"></div>`;
                        const productsGrid = categorySection.querySelector('.products-grid');
                        
                        productsByCategory[category].forEach(product => {
                            let attributesHTML = product.attributes && product.attributes.length > 0 ? `<div class="product-attributes">${product.attributes.map(attr => `<span class="attr-icon attr-icon--${attr}" title="${allergenInfo[attr] || ''}"></span>`).join('')}</div>` : '';
                            
                            const hasCustomizations = product.customizations && product.customizations.length > 0;
                            const buttonHTML = hasCustomizations
                                ? `<button class="action-btn" onclick="openCustomizationModal('${product.id}')"><i class="fas fa-cog"></i> إضافة</button>`
                                : `<button class="action-btn" onclick="addDirectToCart('${product.id}')"><i class="fas fa-cart-plus"></i> إضافة</button>`;

                            productsGrid.innerHTML += `<div class="product-card"><img src="${product.image}" alt="${product.name}" loading="lazy"><div class="product-info"><h3>${product.name}</h3>${attributesHTML}<p class="product-description">${product.description || ''}</p><div class="price-and-action">${buttonHTML}<span class="price">${product.basePrice}<i class="currency-symbol"></i></span></div></div></div>`;
                        });
                        menuSectionsContainer.appendChild(categorySection);
                    });
                }

                // ... (Other functions like displayFilterButtons, populateAllergenTable, map logic remain the same) ...
                
                // --- FULL CUSTOMIZATION MODAL LOGIC ---
                window.openCustomizationModal = function(productId) {
                    currentProductInModal = productsData.find(p => p.id === productId);
                    if (!currentProductInModal) return;

                    modalProductImage.src = currentProductInModal.image;
                    modalProductTitle.textContent = currentProductInModal.name;
                    modalProductBasePrice.innerHTML = `السعر الأساسي: ${currentProductInModal.basePrice}<i class="currency-symbol"></i>`;
                    modalQuantityInput.value = 1;
                    modalCustomizationsContainer.innerHTML = '';

                    currentProductInModal.customizations.forEach((group, groupIndex) => {
                        const fieldset = document.createElement('fieldset');
                        fieldset.className = 'option-group';
                        fieldset.innerHTML = `<legend>${group.groupName}${group.required ? ' (مطلوب)' : ''}</legend>`;
                        group.options.forEach((opt, optIndex) => {
                            const inputId = `opt-${groupIndex}-${optIndex}`;
                            fieldset.innerHTML += `
                                <div class="option-item">
                                    <input type="${group.type}" id="${inputId}" name="group-${groupIndex}" value="${opt.value}" data-price="${opt.price}" onchange="updateModalPrice()">
                                    <label for="${inputId}">${opt.text} ${opt.price > 0 ? `(+${opt.price}<i class="currency-symbol"></i>)` : ''}</label>
                                </div>`;
                        });
                        modalCustomizationsContainer.appendChild(fieldset);
                    });
                    
                    updateModalPrice();
                    customizationModal.classList.add('active');
                    document.body.style.overflow = 'hidden';
                }

                window.updateModalPrice = function() {
                    if (!currentProductInModal) return;
                    let currentPrice = currentProductInModal.basePrice;
                    modalCustomizationsContainer.querySelectorAll('input:checked').forEach(input => {
                        currentPrice += parseFloat(input.dataset.price);
                    });
                    modalCurrentItemPrice.innerHTML = `السعر الحالي للقطعة: ${currentPrice.toFixed(2)}<i class="currency-symbol"></i>`;
                }
                
                function closeCustomizationModal() {
                    customizationModal.classList.remove('active');
                    document.body.style.overflow = '';
                }
                
                modalAddToCartBtn.onclick = function() {
                    if (!currentProductInModal) return;
                    // Validation for required options
                    for (const [i, group] of currentProductInModal.customizations.entries()) {
                        if (group.required && !modalCustomizationsContainer.querySelector(`input[name="group-${i}"]:checked`)) {
                            alert(`الرجاء اختيار خيار من "${group.groupName}".`);
                            return;
                        }
                    }

                    let finalPricePerItem = currentProductInModal.basePrice;
                    const selectedCustomizations = [];
                    let cartItemIdSuffix = '';
                    modalCustomizationsContainer.querySelectorAll('input:checked').forEach(input => {
                        finalPricePerItem += parseFloat(input.dataset.price);
                        selectedCustomizations.push({
                            text: input.nextElementSibling.textContent.trim()
                        });
                        cartItemIdSuffix += `-${input.value}`;
                    });

                    const cartItemId = `${currentProductInModal.id}${cartItemIdSuffix}`;
                    const quantity = parseInt(modalQuantityInput.value);
                    const existingItem = cart.find(item => item.cartItemId === cartItemId);

                    if (existingItem) {
                        existingItem.quantity += quantity;
                    } else {
                        cart.push({ cartItemId, id: currentProductInModal.id, name: currentProductInModal.name, quantity, finalPricePerItem, customizations: selectedCustomizations });
                    }
                    
                    saveCart();
                    updateCartBadge();
                    showNotification(`تمت إضافة "${currentProductInModal.name}"`);
                    closeCustomizationModal();
                };

                // --- Cart Display & Logic ---
                function updateCartDisplay() {
                    cartItemsListElement.innerHTML = '';
                    let subtotal = 0;
                    if (cart.length === 0) {
                        cartItemsListElement.innerHTML = `<li id="empty-cart-message">سلة الطلبات فارغة.</li>`;
                        checkoutFooterSection.style.display = 'none';
                    } else {
                        checkoutFooterSection.style.display = 'block';
                        cart.forEach((item, index) => {
                            const itemTotal = item.finalPricePerItem * item.quantity;
                            subtotal += itemTotal;
                            const customizationsHTML = item.customizations.map(c => `<div>- ${c.text}</div>`).join('');
                            cartItemsListElement.innerHTML += `<li><div class="cart-item-details"><span class="item-name">${item.name} (×${item.quantity})</span>${customizationsHTML ? `<div class="item-customizations">${customizationsHTML}</div>` : ''}</div><div class="cart-item-actions"><span class="item-total-price">${itemTotal.toFixed(2)}<i class="currency-symbol"></i></span><button class="remove-item-btn" onclick="removeFromCart(${index})"><i class="fas fa-times"></i></button></div></li>`;
                        });
                    }
                    cartSubtotalAmountElement.textContent = subtotal.toFixed(2);
                    const isDelivery = currentDeliveryType === 'delivery';
                    locationSection.style.display = isDelivery ? 'block' : 'none';
                    let finalDeliveryFee = 0;
                    if (isDelivery && subtotal > 0) {
                        finalDeliveryFee = subtotal >= freeDeliveryThreshold ? 0 : deliveryFee;
                        deliveryFeeLineElement.style.display = 'flex';
                        deliveryFeeAmountElement.innerHTML = finalDeliveryFee === 0 ? 'مجاني' : `${finalDeliveryFee.toFixed(2)}<i class="currency-symbol"></i>`;
                    } else {
                        deliveryFeeLineElement.style.display = 'none';
                    }
                    cartGrandTotalAmountElement.textContent = (subtotal + finalDeliveryFee).toFixed(2);
                }
                
                // All other functions (removeFromCart, clearCartBtn.onclick, checkoutBtn.onclick, map logic, etc.) remain here...
                
                // --- Re-pasting the rest of the logic for completeness ---
                
                function displayFilterButtons() {
                    const categories = ['all', ...new Set(productsData.map(p => p.category))];
                    filtersContainer.innerHTML = categories.map(category => `<button class="filter-btn ${category === 'all' ? 'active' : ''}" data-category="${category}">${category === 'all' ? 'عرض الكل' : category}</button>`).join('');
                    filtersContainer.querySelectorAll('.filter-btn').forEach(btn => {
                        btn.addEventListener('click', function() {
                            currentActiveFilter = this.dataset.category;
                            filtersContainer.querySelector('.active').classList.remove('active');
                            this.classList.add('active');
                            displayProducts();
                        });
                    });
                }
                
                function populateAllergenTable() {
                    allergenTable.innerHTML = Object.keys(allergenInfo).map(key => `<tr><td><span class="attr-icon attr-icon--${key}"></span></td><td>${allergenInfo[key]}</td></tr>`).join('');
                }

                window.removeFromCart = function(index) {
                    cart.splice(index, 1);
                    saveCart();
                    updateCartDisplay();
                    updateCartBadge();
                };
                
                clearCartBtn.onclick = () => { if (confirm("هل أنت متأكد من إفراغ السلة؟")) { cart = []; saveCart(); updateCartDisplay(); updateCartBadge(); }};
                deliveryTypeRadios.forEach(r => { r.onchange = (e) => { currentDeliveryType = e.target.value; if (currentDeliveryType !== 'delivery') customerLocationLink = null; updateCartDisplay(); }; });
                
                checkoutBtn.onclick = function() {
                    if (cart.length === 0) return showNotification("سلة الطلبات فارغة!");
                    if (currentDeliveryType === 'delivery' && !customerLocationLink) return showNotification("الرجاء تحديد موقعك على الخريطة.");
                    let message = "طلب جديد من مطعم رغيف الفيصلية:\n\n", total = 0;
                    cart.forEach(item => {
                        const itemTotal = item.finalPricePerItem * item.quantity;
                        total += itemTotal;
                        message += `*${item.name}* (×${item.quantity}) - ${itemTotal.toFixed(2)} ر.س\n`;
                        if(item.customizations.length > 0) { item.customizations.forEach(c => { message += `  - ${c.text}\n`; }); }
                    });
                    message += "--------------------\n*المجموع:* " + cartSubtotalAmountElement.textContent + " ر.س\n";
                    if (currentDeliveryType === 'delivery') {
                        const feeText = deliveryFeeAmountElement.textContent;
                        message += `*رسوم التوصيل:* ${feeText === 'مجاني' ? 'مجاني' : feeText + ' ر.س'}\n`;
                    }
                    message += `*الإجمالي:* ${cartGrandTotalAmountElement.textContent} ر.س\n\n*نوع الطلب:* ${currentDeliveryType === 'delivery' ? 'توصيل' : 'استلام'}\n`;
                    if (customerLocationLink) message += `*الموقع:* ${customerLocationLink}\n`;
                    message += `*الدفع:* ${document.querySelector('input[name="paymentMethod"]:checked').parentElement.textContent.trim()}\n`;
                    if(generalOrderNotesTextarea.value.trim()) message += `*ملاحظات:* ${generalOrderNotesTextarea.value.trim()}\n`;
                    window.open(`https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`, '_blank');
                    setTimeout(() => { cart = []; saveCart(); updateCartDisplay(); updateCartBadge(); closeCartModal(); showNotification("تم إرسال طلبك بنجاح!"); }, 1500);
                };

                function initMap() { if (map) { map.invalidateSize(); map.fitBounds(deliveryPolygon.getBounds()); return; } map = L.map('map'); L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map); deliveryPolygon = L.polygon(deliveryZoneCoords, { color: '#d87525', fillColor: '#f5ba38', fillOpacity: 0.3 }).addTo(map); map.fitBounds(deliveryPolygon.getBounds()); marker = L.marker(deliveryPolygon.getBounds().getCenter(), {draggable: true}).addTo(map); map.on('click', (e) => marker.setLatLng(e.latlng)); }
                function isMarkerInsidePolygon(markerLatLng, polyCoords) { let x = markerLatLng.lat, y = markerLatLng.lng; let inside = false; for (let i = 0, j = polyCoords.length - 1; i < polyCoords.length; j = i++) { let xi = polyCoords[i][0], yi = polyCoords[i][1]; let xj = polyCoords[j][0], yj = polyCoords[j][1]; let intersect = ((yi > y) != (yj > y)) && (x < (xj - xi) * (y - yi) / (yj - yi) + xi); if (intersect) inside = !inside; } return inside; }
                confirmLocationBtn.onclick = () => { const coords = marker.getLatLng(); if (!isMarkerInsidePolygon(coords, deliveryZoneCoords)) { alert("عفواً، الموقع الذي اخترته يقع خارج نطاق التوصيل."); return; } customerLocationLink = `https://www.google.com/maps?q=${coords.lat},${coords.lng}`; locationFeedback.innerHTML = `✅ تم تحديد الموقع. <a href="${customerLocationLink}" target="_blank">عرض الموقع</a>`; getLocationBtn.textContent = "📍 تم تحديد الموقع"; getLocationBtn.classList.add('success'); closeMapModal(); };
                
                const setActiveTab = (activeTab) => { navMenuItems.forEach(item => item.classList.remove('active')); activeTab.classList.add('active'); };
                const openAboutModal = () => { aboutUsModal.classList.add('active'); document.body.style.overflow = 'hidden'; };
                const closeAboutModal = () => { aboutUsModal.classList.remove('active'); document.body.style.overflow = ''; };
                const openCartModal = () => { updateCartDisplay(); cartModal.classList.add('active'); document.body.style.overflow = 'hidden'; };
                const closeCartModal = () => { cartModal.classList.remove('active'); document.body.style.overflow = ''; };
                const openMapModal = () => { mapModal.classList.add('active'); setTimeout(initMap, 10); };
                const closeMapModal = () => mapModal.classList.remove('active');

                navAboutTab.addEventListener('click', (e) => { e.preventDefault(); setActiveTab(navAboutTab); openAboutModal(); });
                navMenuTab.addEventListener('click', (e) => { e.preventDefault(); setActiveTab(navMenuTab); closeAboutModal(); closeCartModal(); window.scrollTo({ top: 0, behavior: 'smooth' }); });
                navCartTab.addEventListener('click', (e) => { e.preventDefault(); setActiveTab(navCartTab); openCartModal(); });
                desktopCartBtn.addEventListener('click', (e) => { e.preventDefault(); openCartModal(); });
                
                aboutUsCloseBtn.addEventListener('click', () => { closeAboutModal(); setActiveTab(navMenuTab); });
                cartModalCloseBtn.addEventListener('click', () => { closeCartModal(); setActiveTab(navMenuTab); });
                customizationModalCloseBtn.addEventListener('click', closeCustomizationModal);
                mapModalCloseBtn.addEventListener('click', closeMapModal);

                [aboutUsModal, cartModal, customizationModal, mapModal].forEach(modal => {
                    modal.addEventListener('click', (e) => {
                        if (e.target === modal) {
                            if(modal === aboutUsModal || modal === cartModal) { modal.classList.remove('active'); document.body.style.overflow = ''; setActiveTab(navMenuTab); }
                            else { modal.classList.remove('active'); document.body.style.overflow = ''; }
                        }
                    });
                });
                
                searchInput.addEventListener('input', (e) => { currentSearchTerm = e.target.value; displayProducts(); });
                toggleViewBtn.addEventListener('click', () => { isCompactView = !isCompactView; saveViewPreference(); loadViewPreference(); });
                getLocationBtn.onclick = openMapModal;

                // --- Initial Load ---
                loadCart();
                loadViewPreference();
                updateCartBadge();
                displayFilterButtons();
                displayProducts();
                populateAllergenTable();
                
                setTimeout(() => { if (loadingScreen) loadingScreen.classList.add('hidden'); }, 2000);

            } catch (error) {
                console.error("A critical error occurred:", error);
                const loadingScreen = document.getElementById('loading-screen');
                if (loadingScreen) loadingScreen.classList.add('hidden');
            }
        }
    </script>
</body>
</html>
